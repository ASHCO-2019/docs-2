
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Highlighters Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="memory-panel.html" />
    
    
    <link rel="prev" href="inspector-panel.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                    Getting started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../getting-started/bugzilla.html">
            
                <a href="../getting-started/bugzilla.html">
            
                    
                    Get a Bugzilla account
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../getting-started/build.html">
            
                <a href="../getting-started/build.html">
            
                    
                    Get and build the code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../getting-started/development-profiles.html">
            
                <a href="../getting-started/development-profiles.html">
            
                    
                    Create a development profile
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../contributing.html">
            
                <a href="../contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../contributing/find-bugs.html">
            
                <a href="../contributing/find-bugs.html">
            
                    
                    Find bugs to work on
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../contributing/fixing-bugs.html">
            
                <a href="../contributing/fixing-bugs.html">
            
                    
                    How to fix a bug
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../contributing/code-reviews.html">
            
                <a href="../contributing/code-reviews.html">
            
                    
                    Code reviews
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../contributing/code-reviews-setup.html">
            
                <a href="../contributing/code-reviews-setup.html">
            
                    
                    Set up for code reviews
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../contributing/code-reviews-find-reviewer.html">
            
                <a href="../contributing/code-reviews-find-reviewer.html">
            
                    
                    Find a reviewer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../contributing/making-prs.html">
            
                <a href="../contributing/making-prs.html">
            
                    
                    Send your code for review
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../contributing/code-reviews-checklist.html">
            
                <a href="../contributing/code-reviews-checklist.html">
            
                    
                    Reviews checklist
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../contributing/landing-code.html">
            
                <a href="../contributing/landing-code.html">
            
                    
                    Landing code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../contributing/levelling-up.html">
            
                <a href="../contributing/levelling-up.html">
            
                    
                    Levelling up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../contributing/coding-standards.html">
            
                <a href="../contributing/coding-standards.html">
            
                    
                    Coding standards
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" data-path="../contributing/javascript.html">
            
                <a href="../contributing/javascript.html">
            
                    
                    JavaScript
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1.1" data-path="../contributing/eslint.html">
            
                <a href="../contributing/eslint.html">
            
                    
                    ESLint
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.6.2" data-path="../contributing/css.html">
            
                <a href="../contributing/css.html">
            
                    
                    CSS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../contributing/filing-good-bugs.html">
            
                <a href="../contributing/filing-good-bugs.html">
            
                    
                    Filing good bugs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../contributing/performance.html">
            
                <a href="../contributing/performance.html">
            
                    
                    Investigating performance issues
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../contributing/react-performance-tips.html">
            
                <a href="../contributing/react-performance-tips.html">
            
                    
                    Writing efficient React code
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../tests/">
            
                <a href="../tests/">
            
                    
                    Automated tests
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Running tests
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../tests/xpcshell.html">
            
                <a href="../tests/xpcshell.html">
            
                    
                    xpcshell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../tests/mochitest-chrome.html">
            
                <a href="../tests/mochitest-chrome.html">
            
                    
                    Chrome mochitests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../tests/mochitest-devtools.html">
            
                <a href="../tests/mochitest-devtools.html">
            
                    
                    DevTools mochitests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../tests/node-tests.html">
            
                <a href="../tests/node-tests.html">
            
                    
                    Node tests
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../tests/writing-tests.html">
            
                <a href="../tests/writing-tests.html">
            
                    
                    Writing tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../tests/debugging-intermittents.html">
            
                <a href="../tests/debugging-intermittents.html">
            
                    
                    Debugging intermittent failures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../tests/performance-tests.html">
            
                <a href="../tests/performance-tests.html">
            
                    
                    Performance tests (DAMP)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../tests/writing-perf-tests.html">
            
                <a href="../tests/writing-perf-tests.html">
            
                    
                    Writing a new test
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../tests/writing-perf-tests-example.html">
            
                <a href="../tests/writing-perf-tests-example.html">
            
                    
                    Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.3" data-path="../tests/writing-perf-tests-tips.html">
            
                <a href="../tests/writing-perf-tests-tips.html">
            
                    
                    Advanced tips
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../files/">
            
                <a href="../files/">
            
                    
                    Files and directories
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../files/adding-files.html">
            
                <a href="../files/adding-files.html">
            
                    
                    Adding New Files
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="tools.md">
            
                <span>
            
                    
                    Tool Architectures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="inspector.html">
            
                <a href="inspector.html">
            
                    
                    Inspector
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="inspector-panel.html">
            
                <a href="inspector-panel.html">
            
                    
                    Panel Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.1.2" data-path="highlighters.html">
            
                <a href="highlighters.html">
            
                    
                    Highlighters
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="memory-panel.html">
            
                <a href="memory-panel.html">
            
                    
                    Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="debugger-panel.html">
            
                <a href="debugger-panel.html">
            
                    
                    Debugger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="responsive-design-mode.html">
            
                <a href="responsive-design-mode.html">
            
                    
                    Responsive Design Mode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="console-panel.html">
            
                <a href="console-panel.html">
            
                    
                    Console
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../frontend/frontend.md">
            
                <span>
            
                    
                    Frontend
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../frontend/svgs.html">
            
                <a href="../frontend/svgs.html">
            
                    
                    Panel SVGs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../frontend/react.html">
            
                <a href="../frontend/react.html">
            
                    
                    React
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.2.1" data-path="../frontend/react-guidelines.html">
            
                <a href="../frontend/react-guidelines.html">
            
                    
                    Guidelines
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../frontend/redux.html">
            
                <a href="../frontend/redux.html">
            
                    
                    Redux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.3.1" data-path="../frontend/redux-guidelines.html">
            
                <a href="../frontend/redux-guidelines.html">
            
                    
                    Guidelines
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../frontend/telemetry.html">
            
                <a href="../frontend/telemetry.html">
            
                    
                    Telemetry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../frontend/csp.html">
            
                <a href="../frontend/csp.html">
            
                    
                    Content Security Policy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../backend/backend.md">
            
                <span>
            
                    
                    Backend
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../backend/protocol.html">
            
                <a href="../backend/protocol.html">
            
                    
                    Remote Debugging Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../backend/client-api.html">
            
                <a href="../backend/client-api.html">
            
                    
                    Client API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../backend/debugger-api.html">
            
                <a href="../backend/debugger-api.html">
            
                    
                    Debugger API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../backend/backward-compatibility.html">
            
                <a href="../backend/backward-compatibility.html">
            
                    
                    Backward Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" >
            
                <span>
            
                    
                    Actors
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.5.1" data-path="../backend/actor-hierarchy.html">
            
                <a href="../backend/actor-hierarchy.html">
            
                    
                    Actors Organization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.2" data-path="../backend/actor-e10s-handling.html">
            
                <a href="../backend/actor-e10s-handling.html">
            
                    
                    Handling Multi-Processes in Actors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.3" data-path="../backend/protocol.js.html">
            
                <a href="../backend/protocol.js.html">
            
                    
                    Writing Actors With protocol.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.4" data-path="../backend/actor-registration.html">
            
                <a href="../backend/actor-registration.html">
            
                    
                    Registering A New Actor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.5" data-path="../backend/actor-best-practices.html">
            
                <a href="../backend/actor-best-practices.html">
            
                    
                    Actor Best Practices
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../preferences.html">
            
                <a href="../preferences.html">
            
                    
                    Preferences
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../about-documentation.html">
            
                <a href="../about-documentation.html">
            
                    
                    About this documentation
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Highlighters</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="highlighters">Highlighters</h1>
<p>This article provides technical documentation about DevTools highlighters.</p>
<p>By highlighter, we mean anything that DevTools displays on top of the content page, in order to highlight an element, a set of elements or shapes to users.</p>
<p>The most obvious form of highlighter is the box-model highlighter, whose job is to display the 4 box-model regions on top of a given element in the content page, as illustrated in the following screen capture:</p>
<p><img src="../resources/box-model-highlighter-screenshot.png" alt="Box-model highlighter"></p>
<p>But there can be a wide variety of highlighters. In particular, highlighters are a pretty good way to give detailed information about:</p>
<ul>
<li>the exact form of a css shape,</li>
<li>how a css transform applied to an element,</li>
<li>which are all the elements that match a given selector,</li>
<li>...</li>
</ul>
<h2 id="using-highlighters">Using highlighters</h2>
<p>Highlighters run on the debuggee side, not on the toolbox side. This is so that it&apos;s possible to highlight elements on a remote device for instance. This means you need to go through the <a href="protocol.md">Remote Debugging Protocol</a> to use a highlighter.</p>
<p>The InspectorFront provides the following method:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getHighlighterByType(typeName)</code></td>
<td>Instantiate a new highlighter, given its type (as a String). At the time of writing, the available types of highlighters are: <code>CssGridHighlighter</code>, <code>BoxModelHighlighter</code>, <code>CssTransformHighlighter</code>, <code>FlexboxHighlighter</code>, <code>FontsHighlighter</code>, <code>GeometryEditorHighlighter</code>, <code>MeasuringToolHighlighter</code>, <code>PausedDebuggerOverlay</code>, <code>RulersHighlighter</code>, <code>SelectorHighlighter</code> and <code>ShapesHighlighter</code>. This returns a promise that resolves to the new instance of <a href="https://wiki.mozilla.org/DevTools/protocol.js" target="_blank">protocol.js</a> actor.</td>
</tr>
</tbody>
</table>
<h3 id="the-highlighter-api">The highlighter API</h3>
<p>When getting a highlighter via <code>InspectorFront.getHighlighterByType(typeName)</code>, the right type of highlighter will be instantiated on the server-side and will be wrapped into a <code>CustomHighlighterActor</code> and that&apos;s what will be returned to the caller. This means that all types of highlighters share the same following API:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>show(NodeActor node[, Object options])</code></td>
<td>Highlighters are hidden by default. Calling this method is what makes them visible. The first, mandatory, parameter should be a NodeActor. NodeActors are what the WalkerActor return. It&apos;s easy to get a NodeActor for an existing DOM node. For example <code>toolbox.walker.querySelector(toolbox.walker.rootNode, &quot;css selector&quot;)</code> resolves to a NodeFront (the client-side version of the NodeActor) which can be used as the first parameter. The second, optional, parameter depends on the type of highlighter being used.</td>
</tr>
<tr>
<td><code>hide()</code></td>
<td>Hides the highlighter.</td>
</tr>
<tr>
<td><code>finalize()</code></td>
<td>Destroys the highlighter.</td>
</tr>
</tbody>
</table>
<h2 id="creating-new-highlighters">Creating new highlighters</h2>
<p>Before digging into how one goes about adding a new type of highlighter to the DevTools, it is worth understanding how are highlighters displayed in the page.</p>
<h3 id="inserting-content-in-the-page">Inserting content in the page</h3>
<p>Highlighters use web technology themselves to display the required information on screen. For instance, the box-model highlighter uses SVG to draw the margin, border, padding and content regions over the highlighted node.</p>
<p>This means the highlighter content needs to be inserted in the page, but in a non-intrusive way. Indeed, the DevTools should never alter the page unless the alteration was done by the user (like changing the DOM using the inspector or a CSS rule via the style-editor for example). So simply appending the highlighter&apos;s markup in the content document is not an option.</p>
<p>Furthermore, highlighters not only need to work with Firefox Desktop, but they should work just as well on Firefox OS, Firefox for Android, and more generally anything that runs the Gecko rendering engine. Therefore appending the highlighter&apos;s markup to the browser chrome XUL structure isn&apos;t an option either.</p>
<p>To this end, DevTools highlighters make use of a (chrome-only) API:</p>
<pre><code> /**
  * Chrome document anonymous content management.
  * This is a Chrome-only API that allows inserting fixed positioned anonymous
  * content on top of the current page displayed in the document.
  * The supplied content is cloned and inserted into the document&apos;s CanvasFrame.
  * Note that this only works for HTML documents.
  */
 partial interface Document {
   /**
    * Deep-clones the provided element and inserts it into the CanvasFrame.
    * Returns an AnonymousContent instance that can be used to manipulate the
    * inserted element.
    */
   [ChromeOnly, NewObject, Throws]
   AnonymousContent insertAnonymousContent(Element aElement);

   /**
    * Removes the element inserted into the CanvasFrame given an AnonymousContent
    * instance.
    */
   [ChromeOnly, Throws]
   void removeAnonymousContent(AnonymousContent aContent);
 };
</code></pre><p>Using this API, it is possible for chrome-privileged JS to insert arbitrary DOM elements on top of the content page.</p>
<p>Technically, the DOM element is inserted into the <code>CanvasFrame</code> of the document. The <code>CanvasFrame</code> is part of the rendered frame tree and the DOM element is part of the native anonymous elements of the <code>CanvasFrame</code>.</p>
<p>Consider the following simple example:</p>
<pre><code class="lang-js"> <span class="hljs-keyword">let</span> el = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&quot;div&quot;</span>);
 el.textContent = <span class="hljs-string">&quot;My test element&quot;</span>;
 <span class="hljs-keyword">let</span> insertedEl = <span class="hljs-built_in">document</span>.insertAnonymousContent(el);
</code></pre>
<p>In this example, the test DIV will be inserted in the page, and will be displayed on top of everything else, in a way that doesn&apos;t impact the current layout.</p>
<h3 id="the-anonymouscontent-api">The AnonymousContent API</h3>
<p>In the previous example, the returned <code>insertedEl</code> object isn&apos;t a DOM node, and it certainly is not <code>el</code>. It is a new object, whose type is <code>AnonymousContent</code> (<a href="https://searchfox.org/mozilla-central/source/dom/webidl/AnonymousContent.webidl" target="_blank">see the WebIDL here</a>).</p>
<p>Because of the way content is inserted into the page, it isn&apos;t wanted to give consumers a direct reference to the inserted DOM node. This is why <code>document.insertAnonymousContent(el)</code> actually <strong>clones</strong> <code>el</code> and returns a new object whose API lets consumers make changes to the inserted element in a way that never gives back a reference to the inserted DOM node.</p>
<h3 id="canvasframeanonymouscontenthelper">CanvasFrameAnonymousContentHelper</h3>
<p>In order to help with the API described in the previous section, the <code>CanvasFrameAnonymousContentHelper</code> class was introduced.</p>
<p>Its goal is to provide a simple way for highlighters to insert their content into the page and modify it dynamically later. One of its goal is also to re-insert the highlighters&apos; content on page navigation. Indeed, the frame tree is destroyed when the page is navigated away from since it represents the document element. One thing to note is that highlighter content insertion is asynchronous and <code>CanvasFrameAnonymousContentHelper</code> users must call and wait for its <code>initialize</code> method to resolve.</p>
<p>Using this helper is quite simple:</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> helper = <span class="hljs-keyword">new</span> CanvasFrameAnonymousContentHelper(targetActor, <span class="hljs-keyword">this</span>.buildMarkup.bind(<span class="hljs-keyword">this</span>));
<span class="hljs-keyword">await</span> helper.initialize();
</code></pre>
<p>It only requires a <code>targetActor</code>, which highlighters get when they are instantiated, and a callback function that will be used to create and insert the content the first time the highlighter is shown, and every time there&apos;s a page navigation.</p>
<p>The returned object provides the following API:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getTextContentForElement(id)</code></td>
<td>Get the textContent of an element given its ID.</td>
</tr>
<tr>
<td><code>setTextContentForElement(id, text)</code></td>
<td>Set the textContent of an element given its ID.</td>
</tr>
<tr>
<td><code>setAttributeForElement(id, name, value)</code></td>
<td>Set an attribute value of an element given its ID.</td>
</tr>
<tr>
<td><code>getAttributeForElement(id, name)</code></td>
<td>Get an attribute value of an element given its ID.</td>
</tr>
<tr>
<td><code>removeAttributeForElement(id, name)</code></td>
<td>Remove an attribute of an element given its ID.</td>
</tr>
<tr>
<td><code>content</code></td>
<td>This property returns the wrapped AnonymousContent object.</td>
</tr>
<tr>
<td><code>destroy()</code></td>
<td>Destroy the helper instance.</td>
</tr>
</tbody>
</table>
<h3 id="creating-a-new-highlighter-class">Creating a new highlighter class</h3>
<p>A good way to get started is by taking a look at <a href="https://searchfox.org/mozilla-central/rev/1a973762afcbc5066f73f1508b0c846872fe3952/devtools/server/actors/highlighters.js#519-530" target="_blank">existing highlighters here</a>.</p>
<p>Here is some boilerplate code for a new highlighter class:</p>
<pre><code class="lang-js"> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyNewHighlighter</span>(<span class="hljs-params">targetActor</span>) </span>{
   <span class="hljs-keyword">this</span>.doc = targetActor.window.document;
   <span class="hljs-keyword">this</span>.markup = <span class="hljs-keyword">new</span> CanvasFrameAnonymousContentHelper(targetActor, <span class="hljs-keyword">this</span>._buildMarkup.bind(<span class="hljs-keyword">this</span>));
   <span class="hljs-keyword">this</span>.markup.initialize();
 }

 MyNewHighlighter.prototype = {
   destroy: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
     <span class="hljs-keyword">this</span>.doc = <span class="hljs-literal">null</span>;
     <span class="hljs-keyword">this</span>.markup.destroy();
   },

   _buildMarkup: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
     <span class="hljs-keyword">let</span> container = <span class="hljs-keyword">this</span>.markup.anonymousContentDocument.createElement(<span class="hljs-string">&quot;div&quot;</span>);
     container.innerHTML = <span class="hljs-string">&apos;&lt;div id=&quot;new-highlighted-&quot; style=&quot;display:none;&quot;&gt;&apos;</span>;
     <span class="hljs-keyword">return</span> container;
   },

   show: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node, options</span>) </span>{
     <span class="hljs-keyword">this</span>.markup.removeAttributeForElement(<span class="hljs-string">&quot;new-highlighted-el&quot;</span>, <span class="hljs-string">&quot;style&quot;</span>);
   },

   hide: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
     <span class="hljs-keyword">this</span>.markup.setAttributeForElement(<span class="hljs-string">&quot;new-highlighted-el&quot;</span>, <span class="hljs-string">&quot;style&quot;</span>, <span class="hljs-string">&quot;display:none;&quot;</span>);
   }
 };
</code></pre>
<p>In most situations, the <code>container</code> returned by <code>_buildMarkup</code> will be absolutely positioned, and will need to contain elements with IDs, so that these can then later be moved, resized, hidden or shown in <code>show</code> and <code>hide</code> using the AnonymousContent API.</p>
<h3 id="the-autorefreshhighlighter-parent-class">The AutoRefreshHighlighter parent class</h3>
<p>It is worth mentioning this class as it may be a useful parent class to inherit a new highlighter from in some situations.</p>
<p>If the new highlighter&apos;s job is to highlight an element in the DOM, then it most likely should inherit from <code>AutoRefreshHighlighter</code>.</p>
<p>The <code>AutoRefreshHighlighter</code> class updates itself in a loop, checking if the currently highlighted node&apos;s geometry has changed since the last iteration. This is useful to make sure the highlighter <strong>follows</strong> the highlighted node around, in case the layout around it changes, or in case it is an animated node.</p>
<p>Sub classes must implement the following methods:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_show()</code></td>
<td>Called when the highlighter should be shown.</td>
</tr>
<tr>
<td><code>_update()</code></td>
<td>Called while the highlighter is shown and the geometry of the current node changes.</td>
</tr>
<tr>
<td><code>_hide()</code></td>
<td>Called when the highlighter should be hidden.</td>
</tr>
</tbody>
</table>
<p>Sub classes will have access to the following properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>this.currentNode</code></td>
<td>The node to be shown.</td>
</tr>
<tr>
<td><code>this.currentQuads</code></td>
<td>All of the node&apos;s box model region quads.</td>
</tr>
<tr>
<td><code>this.win</code></td>
<td>The current window</td>
</tr>
</tbody>
</table>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="inspector-panel.html" class="navigation navigation-prev " aria-label="Previous page: Panel Architecture">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="memory-panel.html" class="navigation navigation-next " aria-label="Next page: Memory">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Highlighters","level":"1.6.1.2","depth":3,"next":{"title":"Memory","level":"1.6.2","depth":2,"path":"tools/memory-panel.md","ref":"tools/memory-panel.md","articles":[]},"previous":{"title":"Panel Architecture","level":"1.6.1.1","depth":3,"path":"tools/inspector-panel.md","ref":"tools/inspector-panel.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["hints"],"pluginsConfig":{"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"index.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"tools/highlighters.md","mtime":"2020-11-02T03:30:13.903Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-11-02T03:31:44.152Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

